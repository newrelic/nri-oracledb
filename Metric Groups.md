| Metric Group | SQL Query | Affected Metrics |
| --- | --- | --- |
| `cdb_datafiles_offline` | SELECT<br/>&nbsp;&nbsp;sum(CASE WHEN ONLINE_STATUS IN ('ONLINE', 'SYSTEM','RECOVER') THEN 0 ELSE 1 END)<br/>&nbsp;&nbsp;&nbsp;&nbsp;AS "CDB_DATAFILES_OFFLINE" , TABLESPACE_NAME<br/>FROM dba_data_files<br/>&nbsp;&nbsp;WHERE TABLESPACE_NAME IN ('%')<br/>GROUP BY TABLESPACE_NAME | tablespace.offlineCDBDatafiles |
| `db_id_instance_metric` | SELECT<br/>&nbsp;&nbsp;t1.INST_ID, t2.DBID<br/>FROM (SELECT INST_ID FROM gv$instance) t1,<br/>&nbsp;&nbsp;(SELECT DBID FROM v$database) t2 | dbID |
| `db_id_tablespace_metric` | SELECT<br/>&nbsp;&nbsp;t1.TABLESPACE_NAME, t2.DBID<br/>FROM (SELECT TABLESPACE_NAME FROM DBA_TABLESPACES) t1,<br/>&nbsp;&nbsp;(SELECT DBID FROM v$database) t2 | dbID |
| `global_name_instance_metric` | SELECT<br/>&nbsp;&nbsp;t1.INST_ID, t2.GLOBAL_NAME<br/>FROM (SELECT INST_ID FROM gv$instance) t1,<br/>&nbsp;&nbsp;(SELECT GLOBAL_NAME FROM global_name) t2 | globalName |
| `global_name_tablespace_metric` | SELECT<br/>&nbsp;&nbsp;t1.TABLESPACE_NAME, t2.GLOBAL_NAME<br/>FROM (SELECT TABLESPACE_NAME FROM DBA_TABLESPACES) t1,<br/>&nbsp;&nbsp;(SELECT GLOBAL_NAME FROM global_name) t2 | globalName |
| `locked_accounts` | SELECT<br/>&nbsp;&nbsp;INST_ID, LOCKED_ACCOUNTS<br/>FROM (SELECT count(1) AS "LOCKED_ACCOUNTS"<br/>&nbsp;&nbsp;&nbsp;&nbsp;FROM cdb_users a, cdb_pdbs b<br/>&nbsp;&nbsp;&nbsp;&nbsp;WHERE a.con_id = b.con_id<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND username IN ('SYS', 'SYSTEM', 'DBSNMP')<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND a.account_status != 'OPEN')<br/>l, gv$instance i | lockedAccounts |
| `oracleLongRunningQueries` | SELECT inst_id, sum(num) AS total FROM ((<br/>&nbsp;&nbsp;SELECT i.inst_id, 1 AS num<br/>&nbsp;&nbsp;FROM gv$session s, gv$instance i<br/>&nbsp;&nbsp;WHERE i.inst_id=s.inst_id AND s.status='ACTIVE'<br/>&nbsp;&nbsp;AND s.type <>'BACKGROUND' AND s.last_call_et > 60<br/>&nbsp;&nbsp;GROUP BY i.inst_id<br/>) UNION (<br/>&nbsp;&nbsp;SELECT i.inst_id, 0 AS num FROM gv$session s, gv$instance i<br/>&nbsp;&nbsp;WHERE i.inst_id=s.inst_id))<br/>GROUP BY inst_id | longRunningQueries |
| `pdb_datafiles_offline` | SELECT<br/>&nbsp;&nbsp;sum(CASE WHEN ONLINE_STATUS IN ('ONLINE', 'SYSTEM','RECOVER') THEN 0 ELSE 1 END)<br/>&nbsp;&nbsp;&nbsp;&nbsp;AS "PDB_DATAFILES_OFFLINE" , a.TABLESPACE_NAME<br/>FROM cdb_data_files a, cdb_pdbs b<br/>&nbsp;&nbsp;WHERE a.con_id = b.con_id AND TABLESPACE_NAME IN ('%')<br/>GROUP BY TABLESPACE_NAME | tablespace.offlinePDBDatafiles |
| `pdb_non_write` | SELECT TABLESPACE_NAME,<br/>&nbsp;&nbsp;sum(CASE WHEN ONLINE_STATUS IN ('ONLINE', 'SYSTEM','RECOVER') THEN 0 ELSE 1 END)<br/>&nbsp;&nbsp;&nbsp;&nbsp;AS "PDB_NON_WRITE_MODE"<br/>FROM cdb_data_files a, cdb_pdbs b<br/>&nbsp;&nbsp;WHERE a.con_id = b.con_id AND TABLESPACE_NAME IN ('%')<br/>GROUP BY TABLESPACE_NAME | tablespace.pdbDatafilesNonWrite |
| `pga_metrics` | SELECT INST_ID, NAME, VALUE FROM gv$pgastat | memory.pgaInUseInBytes<br/>memory.pgaAllocatedInBytes<br/>memory.pgaFreeableInBytes<br/>memory.pgaMaxSizeInBytes |
| `read_write_metrics` | SELECT<br/>&nbsp;&nbsp;INST_ID,<br/>&nbsp;&nbsp;SUM(PHYRDS) AS "PhysicalReads",<br/>&nbsp;&nbsp;SUM(PHYWRTS) AS "PhysicalWrites",<br/>&nbsp;&nbsp;SUM(PHYBLKRD) AS "PhysicalBlockReads",<br/>&nbsp;&nbsp;SUM(PHYBLKWRT) AS "PhysicalBlockWrites",<br/>&nbsp;&nbsp;SUM(READTIM) * 10 AS "ReadTime",<br/>&nbsp;&nbsp;SUM(WRITETIM) * 10 AS "WriteTime"<br/>FROM gv$filestat<br/>GROUP BY INST_ID | disk.reads<br/>disk.writes<br/>disk.blocksRead<br/>disk.blocksWritten<br/>disk.readTimeInMilliseconds<br/>disk.writeTimeInMilliseconds |
| `redo_log_waits` | SELECT<br/>&nbsp;&nbsp;sysevent.total_waits,<br/>&nbsp;&nbsp;inst.inst_id,<br/>&nbsp;&nbsp;sysevent.event<br/>FROM<br/>&nbsp;&nbsp;GV$SYSTEM_EVENT sysevent,<br/>&nbsp;&nbsp;GV$INSTANCE inst<br/>WHERE sysevent.inst_id=inst.inst_id | redoLog.waits<br/>redoLog.logFileSwitch<br/>redoLog.logFileSwitchCheckpointIncomplete<br/>redoLog.logFileSwitchArchivingNeeded<br/>sga.bufferBusyWaits<br/>sga.freeBufferWaits<br/>sga.freeBufferInspected |
| `rollback_segments` | SELECT<br/>&nbsp;&nbsp;SUM(stat.gets) AS gets,<br/>&nbsp;&nbsp;sum(stat.waits) AS waits,<br/>&nbsp;&nbsp;sum(stat.waits)/sum(stat.gets) AS ratio,<br/>&nbsp;&nbsp;inst.inst_id<br/>FROM GV$ROLLSTAT stat, GV$INSTANCE inst<br/>WHERE stat.inst_id=inst.inst_id<br/>GROUP BY inst.inst_id | rollbackSegments.gets<br/>rollbackSegments.waits<br/>rollbackSegments.ratioWait |
| `sga` | SELECT sga.name, sga.value,inst.inst_id<br/>FROM GV$SGA sga, GV$INSTANCE inst<br/>WHERE sga.inst_id=inst.inst_id | sga.fixedSizeInBytes<br/>sga.redoBuffersInBytes |
| `sga_hit_ratio` | SELECT inst.inst_id,(1 - (phy.value - lob.value - dir.value)/ses.value) as ratio<br/>FROM GV$SYSSTAT ses, GV$SYSSTAT lob, GV$SYSSTAT dir, GV$SYSSTAT phy, GV$INSTANCE inst<br/>WHERE ses.name='session logical reads'<br/>&nbsp;&nbsp;AND dir.name='physical reads direct'<br/>&nbsp;&nbsp;AND lob.name='physical reads direct (lob)'<br/>&nbsp;&nbsp;AND phy.name='physical reads'<br/>&nbsp;&nbsp;AND ses.inst_id=inst.inst_id<br/>&nbsp;&nbsp;AND lob.inst_id=inst.inst_id<br/>&nbsp;&nbsp;AND dir.inst_id=inst.inst_id<br/>&nbsp;&nbsp;AND phy.inst_id=inst.inst_id | sga.hitRatio |
| `sga_log_alloc_retries` | SELECT (rbar.value/re.value) as ratio, inst.inst_id<br/>FROM GV$SYSSTAT rbar, GV$SYSSTAT re, GV$INSTANCE inst<br/>WHERE rbar.name like 'redo buffer allocation retries'<br/>&nbsp;&nbsp;AND re.name like 'redo entries'<br/>&nbsp;&nbsp;AND re.inst_id=inst.inst_id AND rbar.inst_id=inst.inst_id | sga.logBufferAllocationRetriesRatio |
| `sga_log_buffer_space_waits` | SELECT count(wait.inst_id) as count,inst.inst_id<br/>FROM GV$SESSION_WAIT wait, GV$INSTANCE inst<br/>WHERE wait.event like 'log buffer space%'<br/>&nbsp;&nbsp;AND inst.inst_id=wait.inst_id<br/>GROUP BY inst.inst_id | sga.logBufferSpaceWaits |
| `sga_shared_pool_dict_cache_ratio` | SELECT (SUM(rcache.getmisses)/SUM(rcache.gets)) as ratio,inst.inst_id<br/>FROM GV$rowcache rcache, GV$INSTANCE inst<br/>WHERE inst.inst_id=rcache.inst_id<br/>GROUP BY inst.inst_id | sga.sharedPoolDictCacheMissRatio |
| `sga_shared_pool_library_cache_hit_ratio` | SELECT libcache.gethitratio as ratio,inst.inst_id<br/>FROM GV$librarycache libcache, GV$INSTANCE inst<br/>WHERE namespace='SQL AREA' AND inst.inst_id=libcache.inst_id | sga.sharedPoolLibraryCacheHitRatio |
| `sga_shared_pool_library_cache_reload_ratio` | SELECT (sum(libcache.reloads)/sum(libcache.pins))  AS ratio,inst.inst_id<br/>FROM GV$librarycache libcache, GV$INSTANCE inst<br/>WHERE inst.inst_id=libcache.inst_id<br/>GROUP BY inst.inst_id | sga.sharedPoolLibraryCacheReloadRatio |
| `sga_shared_pool_library_cache_sharable_statement` | SELECT SUM(sqlarea.sharable_mem) AS sum,inst.inst_id<br/>FROM GV$sqlarea sqlarea, GV$INSTANCE inst<br/>WHERE sqlarea.executions > 5 AND inst.inst_id=sqlarea.inst_id<br/>GROUP BY inst.inst_id | sga.sharedPoolLibraryCacheShareableMemoryPerStatementInBytes |
| `sga_shared_pool_library_cache_shareable_user` | SELECT SUM(250 * sqlarea.users_opening) AS sum,inst.inst_id<br/>FROM GV$sqlarea sqlarea, GV$INSTANCE inst<br/>WHERE inst.inst_id=sqlarea.inst_id<br/>GROUP BY inst.inst_id | sga.sharedPoolLibraryCacheShareableMemoryPerUserInBytes |
| `sgauga_total_memory` | SELECT SUM(value) AS sum,inst.inst_id<br/>FROM GV$sesstat, GV$statname, GV$INSTANCE inst<br/>WHERE name = 'session uga memory max'<br/>&nbsp;&nbsp;AND GV$sesstat.statistic#=GV$statname.statistic#<br/>&nbsp;&nbsp;AND GV$sesstat.inst_id=inst.inst_id<br/>&nbsp;&nbsp;AND GV$statname.inst_id=inst.inst_id<br/>GROUP BY inst.inst_id | sga.ugaTotalMemoryInBytes |
| `sys_metrics` | SELECT INST_ID, METRIC_NAME, VALUE<br/>FROM gv$sysmetric | memory.bufferCacheHitRatio<br/>memory.sortsRatio<br/>memory.redoAllocationHitRatio<br/>query.transactionsPerSecond<br/>query.physicalReadsPerTransaction<br/>query.physicalWritesPerTransaction<br/>disk.physicalReadsPerSecond<br/>query.physicalReadsPerTransaction<br/>disk.physicalWritesPerSecond<br/>query.physicalWritesPerTransaction<br/>disk.physicalLobsReadsPerSecond<br/>query.physicalLobsReadsPerTransaction<br/>disk.physicalLobsWritesPerSecond<br/>query.physicalLobsWritesPerTransaction<br/>memory.redoGeneratedBytesPerSecond<br/>memory.redoGeneratedBytesPerTransaction<br/>db.logonsPerTransaction<br/>db.openCursorsPerSecond<br/>db.openCursorsPerTransaction<br/>db.userCommitsPerSecond<br/>db.userCommitsPercentage<br/>db.userRollbacksPerSecond<br/>db.userRollbacksPercentage<br/>db.userCallsPerSecond<br/>db.userCallsPerTransaction<br/>db.recursiveCallsPerSecond<br/>db.recursiveCallsPerTransaction<br/>db.logicalReadsPerSecond<br/>db.logicalReadsPerTransaction<br/>db.dbwrCheckpointsPerSecond<br/>db.backgroundCheckpointsPerSecond<br/>db.redoWritesPerSecond<br/>db.redoWritesPerTransaction<br/>db.longTableScansPerSecond<br/>db.longTableScansPerTransaction<br/>db.totalTableScansPerSecond<br/>db.totalTableScansPerTransaction<br/>db.fullIndexScansPerSecond<br/>db.fullIndexScansPerTransaction<br/>db.totalIndexScansPerSecond<br/>db.totalIndexScansPerTransaction<br/>db.totalParseCountPerSecond<br/>db.totalParseCountPerTransaction<br/>db.hardParseCountPerSecond<br/>db.hardParseCountPerTransaction<br/>db.parseFailureCountPerSecond<br/>db.parseFailureCountPerTransaction<br/>db.cursorCacheHitsPerAttempts<br/>disk.sortPerSecond<br/>disk.sortPerTransaction<br/>db.rowsPerSort<br/>db.softParseRatio<br/>db.userCallsRatio<br/>db.hostCpuUtilization<br/>network.trafficBytePerSecond<br/>db.enqueueTimeoutsPerSecond<br/>db.enqueueTimeoutsPerTransaction<br/>db.enqueueWaitsPerSecond<br/>db.enqueueWaitsPerTransaction<br/>db.enqueueDeadlocksPerSecond<br/>db.enqueueDeadlocksPerTransaction<br/>db.enqueueRequestsPerSecond<br/>db.enqueueRequestsPerTransaction<br/>db.blockGetsPerSecond<br/>db.blockGetsPerTransaction<br/>db.consistentReadGetsPerSecond<br/>db.blockChangesPerSecond<br/>db.consistentReadGetsPerTransaction<br/>db.blockChangesPerTransaction<br/>db.consistentReadChangesPerSecond<br/>db.consistentReadChangesPerTransaction<br/>db.cpuUsagePerSecond<br/>db.cpuUsagePerTransaction<br/>db.crBlocksCreatedPerSecond<br/>db.crBlocksCreatedPerTransaction<br/>db.crUndoRecordsAppliedPerSecond<br/>db.crUndoRecordsAppliedPerTransaction<br/>db.userRollbackUndoRecordsAppliedPerSecond<br/>db.userRollbackUndoRecordsAppliedPerTransaction<br/>db.leafNodeSplitsPerSecond<br/>db.leafNodeSplitsPerTransaction<br/>db.branchNodeSplitsPerSecond<br/>db.branchNodeSplitsPerTransaction<br/>disk.physicalReadIoRequestsPerSecond<br/>disk.physicalReadBytesPerSecond<br/>db.GcCrBlockRecievedPerSecond<br/>db.GcCrBlockRecievedPerTransaction<br/>db.GcCurrentBlockReceivedPerSecond<br/>db.GcCurrentBlockReceivedPerTransaction<br/>db.globalCacheAverageCrGetTime<br/>db.globalCacheAverageCurrentGetTime<br/>disk.physicalWriteTotalIoRequestsPerSecond<br/>memory.globalCacheBlocksCorrupted<br/>memory.globalCacheBlocksLost<br/>db.currentLogons<br/>db.currentOpenCursors<br/>db.userLimitPercentage<br/>db.sqlServiceResponseTime<br/>db.waitTimeRatio<br/>db.cpuTimeRatio<br/>db.responseTimePerTransaction<br/>db.rowCacheHitRatio<br/>db.rowCacheMissRatio<br/>db.libraryCacheHitRatio<br/>db.libraryCacheMissRatio<br/>db.sharedPoolFreePercentage<br/>db.pgaCacheHitPercentage<br/>db.processLimitPercentage<br/>db.sessionLimitPercentage<br/>db.executionsPerTransaction<br/>db.executionsPerSecond<br/>db.TransactionsPerLogon<br/>db.databaseCpuTimePerSecond<br/>disk.physicalWriteBytesPerSecond<br/>disk.physicalWriteIoRequestsPerSecond<br/>db.blockChangesPerUserCall<br/>db.blockGetsPerUserCall<br/>db.executionsPerUserCall<br/>disk.logicalReadsPerUserCall<br/>db.sortsPerUserCall<br/>db.tableScansPerUserCall<br/>db.osLoad<br/>db.streamsPoolUsagePercentage<br/>network.ioMegabytesPerSecond<br/>network.ioRequestsPerSecond<br/>db.averageActiveSessions<br/>db.activeSerialSessions<br/>db.activeParallelSessions<br/>db.backgroundCpuUsagePerSecond<br/>db.backgroundTimePerSecond<br/>db.hostCpuUsagePerSecond<br/>disk.tempSpaceUsedInBytes<br/>db.sessionCount |
| `sysstat` | SELECT (rbar.value/re.value) as ratio, inst.inst_id<br/>FROM GV$SYSSTAT rbar, GV$SYSSTAT re, GV$INSTANCE inst<br/>WHERE rbar.name like 'redo buffer allocation retries'<br/>&nbsp;&nbsp;AND re.name like 'redo entries'<br/>&nbsp;&nbsp;AND re.inst_id=inst.inst_id AND rbar.inst_id=inst.inst_id | sga.logBufferAllocationRetriesRatio |
| `tablespace_metrics` | SELECT a.TABLESPACE_NAME,<br/>&nbsp;&nbsp;a.USED_PERCENT,<br/>&nbsp;&nbsp;a.USED_SPACE * b.BLOCK_SIZE AS "USED",<br/>&nbsp;&nbsp;a.TABLESPACE_SIZE * b.BLOCK_SIZE AS "SIZE",<br/>&nbsp;&nbsp;b.TABLESPACE_OFFLINE AS "OFFLINE"<br/>FROM DBA_TABLESPACE_USAGE_METRICS a<br/>JOIN (<br/>&nbsp;&nbsp;SELECT TABLESPACE_NAME,<br/>&nbsp;&nbsp;&nbsp;&nbsp;BLOCK_SIZE,<br/>&nbsp;&nbsp;&nbsp;&nbsp;MAX( CASE WHEN status = 'OFFLINE' THEN 1 ELSE 0 END) AS "TABLESPACE_OFFLINE"<br/>&nbsp;&nbsp;FROM DBA_TABLESPACES<br/>&nbsp;&nbsp;GROUP BY TABLESPACE_NAME, BLOCK_SIZE<br/>) b<br/>ON a.TABLESPACE_NAME = b.TABLESPACE_NAME<br/>WHERE a.TABLESPACE_NAME IN ('%s') | tablespace.spaceConsumedInBytes<br/>tablespace.spaceReservedInBytes<br/>tablespace.spaceUsedPercentage<br/>tablespace.isOffline |
